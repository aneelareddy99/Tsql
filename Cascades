/*
CASCADING KEYS:	 SUCH KEYS WHICH ARE USED TO AUTOMATICALLY UPDATE (DELETE) THE REFERENCING COLUMN.
THIS IS APPLICABLE FOR FOREIGN KEYS ONLY.

SYNTAX		:	<COLUMNNAME>  <TYPE>  REFERENCES PARENTTABLE(COLUMN) ON UPDATE CASCADE ON DELETE CASCADE
*/

USE TEMPDB
GO

-- TABLE #1: COURSES TABLE
CREATE TABLE tblCourses
(
CourseName varchar(30) PRIMARY KEY,   
CourseDuration tinyint CHECK (CourseDuration = 120 or CourseDuration = 180),
CourseStatus BIT 			
)

INSERT INTO tblCourses VALUES ('COMPUTERS', 180, 1), ('CIVIL', 180, 1), ('ROBOTICS', 120, 1)

-- TABLE #2: STUDENTS TABLE
CREATE TABLE tblStudents
(
StdID int UNIQUE,	
StdName varchar(40) NOT NULL , 
StdGender CHAR(1) CHECK (StdGender = 'M' OR StdGender = 'F'),
StdAge tinyint CHECK (StdAge >= 18),
StdCourse	varchar(30)	REFERENCES tblCourses(CourseName)	ON UPDATE CASCADE  ON DELETE CASCADE,
CONSTRAINT UQ_ID_NAME UNIQUE (StdID, StdName)		-- THIS IS COMPOSITE KEY. ANY KEY ON MORE THAN 1 COLUMN
)

INSERT INTO tblStudents VALUES (1001, 'SAI', 'M', 29, 'COMPUTERS'), 
(1002, 'JOHN', 'M', 19, 'COMPUTERS'), 	 (1003, 'JEFF', 'M', 20, 'CIVIL'),
(1004, 'JOHNY', 'M', 21, 'COMPUTERS'),	(1005, 'JEFFREY', 'M', 21, 'CIVIL'), 
(1006, 'AMI', 'F', 20, 'COMPUTERS'),	(1007, 'AMIN', 'M', 22, 'CIVIL')

SELECT * FROM tblCourses
SELECT * FROM tblStudents

-- HOW TO TEST "ON UPDATE CASCADE" ?
UPDATE tblCourses SET CourseName = 'CS' WHERE CourseName = 'computers'
SELECT * FROM tblCourses
SELECT * FROM tblStudents

UPDATE tblCourses SET CourseName = 'CS2' WHERE CourseName = 'CS'
SELECT * FROM tblCourses
SELECT * FROM tblStudents


-- TASK : HOW TO IMPLEMENT "ON DELETE CASCADE" ?


-- BIGGER TABLES	: SUCH TABLES WITH MORE THAN 1 GB SIZE 
-- SMALL TABLES		: SUCH TABLES WITH LESS THAN 1 GB SIZE
-- HEAP TABLES		: SUCH TABLES WITHOUT ANY INDEX

-- FOR CASCADING KEY TABLES: IT IS RECOMMENDED TO USE MERGE JOIN OPTION IRRESPECTIVE OF ITS SIZE. 
