CREATE DATABASE TRIG_TEST_DB

USE TRIG_TEST_DB 

create table Reservation1
(
Aircraft_Code varchar(10), No_of_Seats int, Class_Code varchar(10)
)

create table Reservation2
(
Aircraft_Code varchar(10), No_of_Seats int, Class_Code varchar(10)
)

-- REQ 1: WHENEVER WE INSERT DATA INTO 1ST TABLE, SAME DATA SHOULD AUTO INSERT INTO 2ND TABLE?
CREATE TRIGGER TRIG_1
ON
Reservation1
FOR INSERT				-- IN ADDITION TO INSERT
AS
INSERT INTO Reservation2 SELECT * FROM INSERTED  


-- HOW TO TEST ABOVE TRIGGER?
INSERT INTO Reservation1 VALUES ('AI01', 11, 'ECO')
SELECT * FROM Reservation1; SELECT * FROM Reservation2 

INSERT INTO Reservation1 VALUES ('AI02', 22, 'ECO')
SELECT * FROM Reservation1; SELECT * FROM Reservation2 


-- REQ 2: HOW TO PREVENT DML OPERATIONS ON A TABLE?
-- SCENARIO: HOW TO MAKE A TABLE READ ONLY?

CREATE TRIGGER TRIG_2
ON RESERVATION1
INSTEAD OF INSERT, UPDATE, DELETE
AS
PRINT 'THE TABLE IS DISABLED FOR DML OPERATIONS. CONTACT YOUR ADMIN.'

-- HOW TO TEST ABOVE TRIGGER?
DELETE FROM RESERVATION1									-- DELETE DOES NOT WORK.
INSERT INTO Reservation1 VALUES ('AI03', 33, 'ECO')			-- INSERT DOES NOT WORK.

-- HOW TO DEAL WITH EXCEPTIONAL DML ?
DISABLE TRIGGER TRIG_2 ON RESERVATION1

DELETE FROM RESERVATION1				-- DELETE WORKS
SELECT * FROM RESERVATION1				-- TABLE DOES NOT HAVE ANY DATA.

ENABLE TRIGGER TRIG_2 ON RESERVATION1

-- HOW TO REPORT LIST OF TRIGGERS IN A DATABASE?
SELECT * FROM SYS.TRIGGERS 

-- WHICH OF THE TRIGGER HAS MORE PRIORITY?  
			-- OPTION 1: INSTEAD OF				OPTION 2: FOR

-- PARTICIPANTS  FOR POWER BI, MSBI, T-SQL PLAN A ::  WE ARE MEETING TOMORROW.

-- OTHERS ::   DATABASE ARCHITECTURE

				INDEX ARCHITECTURE

/*

Q1. WHICH STRUCTURE CONTROLS TABLE DATA?
